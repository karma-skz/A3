<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Mini CTF</title>
      <link rel="stylesheet" href="style.css">
</head>
<body>
  <header>
    <div class="header-left">
      <h1>Mini CTF</h1>
      <nav>
        <a href="index.html">Home</a>
        <a href="education.html">Education</a>
        <a href="projects.html">Projects</a>
        <a href="ctf.html">CTF</a>
      </nav>
    </div>
    <button id="darkModeToggle" style="margin-top:1em;font-family:inherit;font-size:1em;padding:0.5em 1em;border-radius:8px;border:none;background:var(--main-bg,#232b3a);color:var(--heading,#b388ff);cursor:pointer;box-shadow:0 2px 8px 0 rgba(60,40,120,0.08);">Toggle Dark Mode</button>
  </header>
  <main>
    <section class="ctf">
      <h2>Enter the flags you find!</h2>
      <form id="ctfForm" autocomplete="off" style="display:flex;flex-direction:column;gap:1em;max-width:350px;margin:auto;">
        <input type="text" id="flagInput" placeholder="Enter flag..." style="padding:0.7em;font-size:1em;border-radius:8px;border:1px solid var(--accent,#7c4dff);background:var(--main-bg,#232b3a);color:var(--fg,#e0cfff);">
        <button type="submit" style="padding:0.7em;font-size:1em;border-radius:8px;border:none;background:var(--accent,#7c4dff);color:var(--cv-link,#e0cfff);cursor:pointer;">Submit Flag</button>
      </form>
      <div id="ctfStatus" style="margin-top:2em;text-align:center;"></div>
    </section>
  </main>
  <footer>
    <p>&copy; 2025 My Retro Pixel Website</p>
  </footer>
  <script>
    // Dark mode toggle logic
    const toggleBtn = document.getElementById('darkModeToggle');
    toggleBtn.addEventListener('click', () => {
      document.body.classList.toggle('light-mode');
      localStorage.setItem('theme', document.body.classList.contains('light-mode') ? 'light' : 'dark');
    });
    if (localStorage.getItem('theme') === 'light') {
      document.body.classList.add('light-mode');
    }
    // Mini-CTF logic
    const requiredFlags = [
    //   'flag{source_code}',
      'flag{a}',
    //   'flag{css_hidden}',
      'flag{b}',
    //   'flag{js_puzzle}',
      'flag{c}',
    //   'flag{image_alt}',
      'flag{d}',
    //   'flag{timeline_event}',
      'flag{e}'
    ];
    let foundFlags = JSON.parse(localStorage.getItem('foundFlags') || '[]');
    // On page load, reset foundFlags if all were found in previous session
    if (foundFlags.length === requiredFlags.length) {
      localStorage.removeItem('foundFlags');
      foundFlags = [];
      sessionStorage.removeItem('secretShown');
    }
    function updateStatus() {
      const status = document.getElementById('ctfStatus');
      if (foundFlags.length === requiredFlags.length) {
        if (!sessionStorage.getItem('secretShown')) {
          status.innerHTML = '<b>All flags found! <a id="secretLink" href="secret.html">Go to the secret page</a><br>Note that you won\'t be able to come back to this link unless you resubmit each flag!</b>';
          sessionStorage.setItem('secretShown', '1');
        } else {
          status.innerHTML = `Flags found: ${foundFlags.length} / ${requiredFlags.length}`;
        }
      } else {
        status.innerHTML = `Flags found: ${foundFlags.length} / ${requiredFlags.length}`;
      }
    }
    document.getElementById('ctfForm').addEventListener('submit', function(e) {
      e.preventDefault();
      const input = document.getElementById('flagInput');
      const val = input.value.trim();
      if (requiredFlags.includes(val) && !foundFlags.includes(val)) {
        foundFlags.push(val);
        localStorage.setItem('foundFlags', JSON.stringify(foundFlags));
        input.value = '';
        updateStatus();
      } else {
        input.value = '';
        alert('Invalid or already submitted flag!');
      }
    });
    updateStatus();
  </script>
</body>
</html>